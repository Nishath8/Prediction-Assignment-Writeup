---
title: "Prediction Assignment Writeup"
author: "Nishath Anjum P"
date: "`r Sys.Date()`"
output:
  html_document: default
  word_document: default
  pdf_document: default
---

## Background

Using devices such as accelerometers, it is possible to collect large amounts of data about human activity. While people often measure how much activity they perform, they rarely measure how well they perform it.

In this project, data from accelerometers placed on the belt, forearm, arm, and dumbbell of six participants was used to predict the manner in which a barbell lift was performed. The outcome variable `classe` represents five different exercise execution styles (Aâ€“E).

## Data Loading and Preprocessing

```{r setup, message=FALSE, warning=FALSE}
packages <- c("caret", "randomForest", "rpart", "rpart.plot", "ggplot2")

installed <- packages %in% rownames(installed.packages())
if (any(!installed)) {
  install.packages(packages[!installed], repos = "https://cloud.r-project.org")
}

library(caret)
library(randomForest)
library(rpart)
library(rpart.plot)
library(ggplot2)
```

```{r}
trainingUrl <- "https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv"
testingUrl  <- "https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv"

training <- read.csv(trainingUrl, na.strings = c("NA", "#DIV/0!", ""))
testing  <- read.csv(testingUrl, na.strings = c("NA", "#DIV/0!", ""))
```

Columns with a large proportion of missing values were removed. Additionally, the first seven identifier columns were excluded.

```{r}
na_columns <- colSums(is.na(training)) / nrow(training)

training_clean <- training[, na_columns < 0.95]
testing_clean  <- testing[, na_columns < 0.95]

training_clean <- training_clean[, -(1:7)]
testing_clean  <- testing_clean[, -(1:7)]
```

## Model Building

The cleaned dataset was split into training (70%) and validation (30%) sets. A Random Forest classifier was selected due to its accuracy and robustness.

```{r}
set.seed(123)
inTrain <- createDataPartition(training_clean$classe, p = 0.7, list = FALSE)

trainData <- training_clean[inTrain, ]
testData  <- training_clean[-inTrain, ]

trainData$classe <- as.factor(trainData$classe)
testData$classe  <- as.factor(testData$classe)
```

```{r}
set.seed(123)
rf_model <- randomForest(
  classe ~ .,
  data = trainData,
  ntree = 100
)
```

## Model Evaluation

```{r}
predictions <- predict(rf_model, testData)
confusionMatrix(predictions, testData$classe)
```

The model achieved approximately 99.5% accuracy, corresponding to an estimated out-of-sample error of about 0.5%.

## Prediction on Test Data

```{r}
final_predictions <- predict(rf_model, testing_clean)
final_predictions
```

## Conclusion

A Random Forest model was successfully developed to predict exercise execution style using accelerometer data. The model demonstrated excellent performance with very low out-of-sample error.
